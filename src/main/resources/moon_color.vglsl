const vec3 maximumLight = vec3(1.0F, 1.0F, 1.0F)

uniform vec3 enhancedCelestialsColor;
uniform sampler2D enhancedCelestialsLightmap;

#in vec2 lmcoord;

$
vec4 levelLightmap = texture(lightmap, #lmcoord);

vec4 ambientColor = min(vec4(enhancedCelestialsColor, 1.0F), maximumLight);

vec3 skylight = normalize(vec3(decodedLightmap.g)) * ambientColor;

%s = min(vec4(%s + skylight, maximumLight);